# AI 提示词润色功能

## 功能概述

AI 提示词润色功能使用 Google Gemini 3 Pro 模型，将用户的简单描述转化为符合 Sora 2 最佳实践的专业视频生成提示词。

## 技术实现

### 1. API 路由

**文件**: `src/app/api/enhance-prompt/route.ts`

- 接收用户输入的简单提示词
- 调用 Google Gemini 3 Pro API (gemini-3-pro-preview)
- 使用专业的 Sora 2 Creative Director 系统提示词
- 返回优化后的提示词

**环境变量**:
```bash
GOOGLE_GEMINI_API_KEY=your_api_key_here
```

### 2. 系统提示词设计

系统提示词基于专业 Sora 2 Creative Director 的最佳实践，包含：

- **核心原则**:
  - 默认人物为中国人，说普通话
  - 使用具体的视觉描述
  - 保持 100-150 字符长度
  - 直接输出优化后的提示词

- **结构指南**:
  1. 主体动作：明确的动作动词 + 具体行为
  2. 环境设定：时间、地点、氛围
  3. 视觉风格：镜头运动、光线、色调
  4. 情感基调：通过视觉元素传达

- **一致性规则**:
  - 人物特征：年龄、性别、服装、表情
  - 场景连贯：空间关系、物体位置
  - 风格统一：色调、光线、镜头语言

- **质量检查清单**:
  - 是否包含明确的主体和动作？
  - 是否指定了环境和氛围？
  - 是否有视觉风格描述？
  - 是否符合 100-150 字符限制？
  - 人物是否默认为中国人说普通话？

### 3. UI 组件

#### 润色按钮 (video-workshop.tsx)

在提示词输入框下方添加两个按钮：
- **随机按钮**: 从预设库中随机选择提示词
- **润色按钮**: 调用 AI 优化当前提示词

```typescript
<div className="flex gap-2">
  <button onClick={handleRandomPrompt}>
    随机
  </button>
  <button onClick={handleEnhancePrompt} disabled={!prompt.trim() || enhancing}>
    {enhancing ? "润色中..." : "润色"}
  </button>
</div>
```

#### 润色预览对话框 (prompt-enhance-dialog.tsx)

显示原始提示词和润色后提示词的对比：
- 原始提示词区域（灰色边框）
- 润色后提示词区域（棕色边框，突出显示）
- 提示信息说明
- 取消/确认按钮

### 4. 用户流程

1. 用户在提示词输入框输入简单描述（如："一个人在跑步"）
2. 点击"润色"按钮
3. 系统调用 Gemini 3 Pro API 进行优化
4. 弹出对话框显示原始和优化后的提示词对比
5. 用户确认后，优化后的提示词替换原始输入
6. 用户可以继续编辑或直接生成视频

## 示例

**输入**: "一个人在跑步"

**输出**: "清晨阳光下，一位身穿运动装的中国青年男子在城市公园的林荫道上慢跑，镜头跟随拍摄，暖色调，自然光线，展现健康活力的生活方式"

## 依赖

```json
{
  "@google/generative-ai": "^latest"
}
```

## 配置

在 Vercel 或本地环境中设置环境变量：

```bash
GOOGLE_GEMINI_API_KEY=your_gemini_api_key
```

## 注意事项

1. **API 密钥安全**: 确保 `GOOGLE_GEMINI_API_KEY` 只在服务端使用，不要暴露到客户端
2. **错误处理**: API 调用失败时会显示友好的错误提示
3. **用户体验**: 润色过程中按钮显示"润色中..."状态，防止重复点击
4. **字符限制**: 系统提示词要求输出 100-150 字符，确保提示词简洁有效
5. **默认设置**: 人物默认为中国人说普通话，除非用户特别说明

## 未来优化

1. 添加提示词历史记录
2. 支持多语言输出
3. 提供多个润色版本供用户选择
4. 添加提示词模板库
5. 支持批量润色
